{"version":3,"sources":["../js/app.js","../js/newsService.js","../js/newsView.js"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["document.addEventListener(\"DOMContentLoaded\", runApp);\r\n\r\nfunction runApp() {\r\n    const config = {\r\n        apiKey: '8578cf6cf7104f77a2b30b8259c14ea6',\r\n        baseUrl:'https://newsapi.org/v2',\r\n        sources: ['abc-news', 'bbc-news', 'cnn', 'fox-news', 'the-new-york-times']\r\n    };\r\n    let newsService = new NewsService(config);\r\n    let newsView = new NewsView();\r\n\r\n    Init();\r\n    subscribeForViewEvents();    \r\n    uploadNews(config.sources[0]);\r\n\r\n\r\n    function Init() {\r\n        newsView.addSources(config.sources);\r\n        newsView.Page = 1;\r\n    }\r\n\r\n    function uploadNews(source, page = 1) {\r\n        newsService.getNews(source, page)\r\n            .then(({articles}) => {\r\n                newsView.clearNews();\r\n                newsView.buildArticles(articles);\r\n            })\r\n            .catch(error => {\r\n                newsView.clearNews();\r\n                newsView.printError(error);\r\n            });\r\n    }\r\n\r\n    function subscribeForViewEvents() {\r\n        newsView.onSourceChange(source => {\r\n            newsView.Page = 1;\r\n            uploadNews(source);\r\n        });\r\n        newsView.onPageChange(page => {\r\n            if (page <= 0) {\r\n                return;\r\n            }\r\n\r\n            uploadNews(newsView.CurrentSource, page);\r\n        });\r\n    }\r\n}\r\n","class NewsService {\r\n    constructor({apiKey, baseUrl}) {\r\n        this._apiKey = apiKey;\r\n        this._baseUrl = baseUrl\r\n    }\r\n\r\n    getNews(source, page) {\r\n        let url = `${this._baseUrl}/everything?sources=${source}&page=${page}`;\r\n        let request = new Request(url, {\r\n            headers: new Headers({\r\n                'X-Api-Key': this._apiKey\r\n            })\r\n        });\r\n\r\n        return fetch(request)\r\n            .then(NewsService.handleErrors)\r\n            .then(resp => resp.json());\r\n    }\r\n\r\n    static handleErrors(response) {\r\n        if (!response.ok) {\r\n            throw Error(response.statusText);\r\n        }\r\n\r\n        return response;\r\n    }\r\n}\r\n","const articleMarkup = `\r\n    <article class=\"news-article\">\r\n        <header>\r\n            <h1 class=\"news-title\"></h1>\r\n        </header>\r\n        <section class=\"news-content\">\r\n            <img class=\"news-image\">\r\n            <p class=\"news-description\"></p>\r\n            <a target=\"_blank\" class=\"news-url\">Read more</a>\r\n        </section>\r\n        <footer>\r\n            Published on\r\n            <time class=\"news-publish-date\"></time>\r\n            by <span class=\"news-author\"></span>.\r\n        </footer>\r\n    </article>\r\n`.trim();\r\n\r\nclass NewsView {\r\n    constructor() {\r\n        this._sourceSelectControl = document.querySelector('#newsSources');\r\n        this._newsContainerElement = document.querySelector('#news-container');\r\n        this._pageInputControl = document.querySelector('#page-control');\r\n    }\r\n\r\n    get Page() {\r\n        return this._pageInputControl.value;\r\n    }\r\n\r\n    set Page(page) {\r\n        if (!Number.isInteger(page)) {\r\n            return;\r\n        }\r\n\r\n        this._pageInputControl.value = page;\r\n    }\r\n\r\n    get CurrentSource() {\r\n        return this._sourceSelectControl.value;\r\n    }\r\n\r\n    onSourceChange(callback) {\r\n        this._sourceSelectControl.addEventListener('change', event => callback(event.target.value));\r\n    }\r\n\r\n    onPageChange(callback) {\r\n        this._pageInputControl.addEventListener('change', event => callback(event.target.value));\r\n    }\r\n\r\n    addSources(sources) {\r\n        for(let source of sources) {\r\n            let option = document.createElement('option');\r\n            option.text = source;\r\n            this._sourceSelectControl.add(option);\r\n        }\r\n    }\r\n\r\n    buildArticle(article) {\r\n        let publishedDate = new Date(article.publishedAt);\r\n        let domParser = new DOMParser();\r\n        let articleElement = domParser.parseFromString(articleMarkup, 'text/html').querySelector('.news-article');\r\n\r\n        NewsView.setElementValue(articleElement, '.news-title', article.title);\r\n        NewsView.setElementValue(articleElement, '.news-description', article.description);\r\n        NewsView.setElementValue(articleElement, '.news-author', article.author);\r\n        NewsView.setElementValue(articleElement, '.news-publish-date', publishedDate.toLocaleDateString());\r\n\r\n        NewsView.setElementAttribute(articleElement, 'img', 'src', article.urlToImage);\r\n        NewsView.setElementAttribute(articleElement, '.news-url', 'href', article.url);\r\n        NewsView.setElementAttribute(articleElement, '.news-publish-date', 'datetime', article.publishedAt);\r\n\r\n        this._newsContainerElement.appendChild(articleElement);\r\n    }\r\n\r\n    buildArticles(articles) {\r\n        for(let article of articles) {\r\n            this.buildArticle(article);\r\n        }\r\n    }\r\n\r\n    clearNews() {\r\n        this._newsContainerElement.innerHTML = '';\r\n    }\r\n\r\n    printError(errorMessage) {\r\n        let errorElement = document.createElement(\"p\");\r\n        errorElement.classList.add('error');\r\n        errorElement.innerHTML = `Something went wrong. ${errorMessage}.`;\r\n        this._newsContainerElement.appendChild(errorElement);\r\n        setTimeout(() => this._newsContainerElement.removeChild(errorElement), 10000);\r\n    }\r\n\r\n    static setElementValue(baseElement, selector, value) {\r\n        let element = baseElement.querySelector(selector);\r\n        element.innerHTML = value;\r\n    }\r\n\r\n    static setElementAttribute(baseElement, selector, attribute, value) {\r\n        if (value == null) {\r\n            return;\r\n        }\r\n\r\n        let element = baseElement.querySelector(selector);\r\n        element.setAttribute(attribute, value);\r\n    }\r\n}"]}